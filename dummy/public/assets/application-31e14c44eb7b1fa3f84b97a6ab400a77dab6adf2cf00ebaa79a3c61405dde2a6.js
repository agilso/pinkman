var Hogan={};!function(t,n){function e(t){return String(null===t||t===undefined?"":t)}function i(t){return t=e(t),u.test(t)?t.replace(o,"&amp;").replace(r,"&lt;").replace(l,"&gt;").replace(c,"&#39;").replace(s,"&quot;"):t}t.Template=function(t,e,i,o){this.r=t||this.r,this.c=i,this.options=o,this.text=e||"",this.buf=n?[]:""},t.Template.prototype={r:function(){return""},v:i,t:e,render:function(t,n,e){return this.ri([t],n||{},e)},ri:function(t,n,e){return this.r(t,n,e)},rp:function(t,n,e,i){var o=e[t];return o?(this.c&&"string"==typeof o&&(o=this.c.compile(o,this.options)),o.ri(n,e,i)):""},rs:function(t,n,e){var i=t[t.length-1];if(!a(i))return void e(t,n,this);for(var o=0;o<i.length;o++)t.push(i[o]),e(t,n,this),t.pop()},s:function(t,n,e,i,o,r,l){var c;return(!a(t)||0!==t.length)&&("function"==typeof t&&(t=this.ls(t,n,e,i,o,r,l)),c=""===t||!!t,!i&&c&&n&&n.push("object"==typeof t?t:n[n.length-1]),c)},d:function(t,n,e,i){var o=t.split("."),r=this.f(o[0],n,e,i),l=null;if("."===t&&a(n[n.length-2]))return n[n.length-1];for(var c=1;c<o.length;c++)r&&"object"==typeof r&&o[c]in r?(l=r,r=r[o[c]]):r="";return!(i&&!r)&&(i||"function"!=typeof r||(n.push(l),r=this.lv(r,n,e),n.pop()),r)},f:function(t,n,e,i){for(var o=!1,r=null,l=!1,c=n.length-1;c>=0;c--)if((r=n[c])&&"object"==typeof r&&t in r){o=r[t],l=!0;break}return l?(i||"function"!=typeof o||(o=this.lv(o,n,e)),o):!i&&""},ho:function(t,n,e,i,o){var r=this.c,l=this.options;l.delimiters=o;var i=t.call(n,i);return i=null==i?String(i):i.toString(),this.b(r.compile(i,l).render(n,e)),!1},b:n?function(t){this.buf.push(t)}:function(t){this.buf+=t},fl:n?function(){var t=this.buf.join("");return this.buf=[],t}:function(){var t=this.buf;return this.buf="",t},ls:function(t,n,e,i,o,r,l){var c=n[n.length-1],s=null;if(!i&&this.c&&t.length>0)return this.ho(t,c,e,this.text.substring(o,r),l);if("function"==typeof(s=t.call(c))){if(i)return!0;if(this.c)return this.ho(s,c,e,this.text.substring(o,r),l)}return s},lv:function(t,n,i){var o=n[n.length-1],r=t.call(o);return"function"==typeof r&&(r=e(r.call(o)),this.c&&~r.indexOf("{{"))?this.c.compile(r,this.options).render(o,i):e(r)}};var o=/&/g,r=/</g,l=/>/g,c=/\'/g,s=/\"/g,u=/[&<>\"\']/,a=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}}("undefined"!=typeof exports?exports:Hogan),function(t){function n(t){"}"===t.n.substr(t.n.length-1)&&(t.n=t.n.substring(0,t.n.length-1))}function e(t){return t.trim?t.trim():t.replace(/^\s*|\s*$/g,"")}function i(t,n,e){if(n.charAt(e)!=t.charAt(0))return!1;for(var i=1,o=t.length;i<o;i++)if(n.charAt(e+i)!=t.charAt(i))return!1;return!0}function o(t,n,e,i){for(var c=[],s=null,u=null;t.length>0;)if(u=t.shift(),"#"==u.tag||"^"==u.tag||r(u,i))e.push(u),u.nodes=o(t,u.tag,e,i),c.push(u);else{if("/"==u.tag){if(0===e.length)throw new Error("Closing tag without opener: /"+u.n);if(s=e.pop(),u.n!=s.n&&!l(u.n,s.n,i))throw new Error("Nesting error: "+s.n+" vs. "+u.n);return s.end=u.i,c}c.push(u)}if(e.length>0)throw new Error("missing closing tag: "+e.pop().n);return c}function r(t,n){for(var e=0,i=n.length;e<i;e++)if(n[e].o==t.n)return t.tag="#",!0}function l(t,n,e){for(var i=0,o=e.length;i<o;i++)if(e[i].c==t&&e[i].o==n)return!0}function c(t){return t.replace(k,"\\\\").replace(y,'\\"').replace(b,"\\n").replace(v,"\\r")}function s(t){return~t.indexOf(".")?"d":"f"}function u(t){for(var n="",e=0,i=t.length;e<i;e++){var o=t[e].tag;"#"==o?n+=a(t[e].nodes,t[e].n,s(t[e].n),t[e].i,t[e].end,t[e].otag+" "+t[e].ctag):"^"==o?n+=p(t[e].nodes,t[e].n,s(t[e].n)):"<"==o||">"==o?n+=h(t[e]):"{"==o||"&"==o?n+=f(t[e].n,s(t[e].n)):"\n"==o?n+=g('"\\n"'+(t.length-1==e?"":" + i")):"_v"==o?n+=m(t[e].n,s(t[e].n)):o===undefined&&(n+=g('"'+c(t[e])+'"'))}return n}function a(t,n,e,i,o,r){return"if(_.s(_."+e+'("'+c(n)+'",c,p,1),c,p,0,'+i+","+o+',"'+r+'")){_.rs(c,p,function(c,p,_){'+u(t)+"});c.pop();}"}function p(t,n,e){return"if(!_.s(_."+e+'("'+c(n)+'",c,p,1),c,p,1,0,0,"")){'+u(t)+"};"}function h(t){return'_.b(_.rp("'+c(t.n)+'",c,p,"'+(t.indent||"")+'"));'}function f(t,n){return"_.b(_.t(_."+n+'("'+c(t)+'",c,p,0)));'}function m(t,n){return"_.b(_.v(_."+n+'("'+c(t)+'",c,p,0)));'}function g(t){return"_.b("+t+");"}var d=/\S/,y=/\"/g,b=/\n/g,v=/\r/g,k=/\\/g,P={"#":1,"^":2,"/":3,"!":4,">":5,"<":6,"=":7,_v:8,"{":9,"&":10};t.scan=function(t,o){function r(){g.length>0&&(y.push(new String(g)),g="")}function l(){for(var t=!0,n=k;n<y.length;n++)if(!(t=y[n].tag&&P[y[n].tag]<P._v||!y[n].tag&&null===y[n].match(d)))return!1;return t}function c(t,n){if(r(),t&&l())for(var e,i=k;i<y.length;i++)y[i].tag||((e=y[i+1])&&">"==e.tag&&(e.indent=y[i].toString()),y.splice(i,1));else n||y.push({tag:"\n"});b=!1,k=y.length}function s(t,n){var i="="+_,o=t.indexOf(i,n),r=e(t.substring(t.indexOf("=",n)+1,o)).split(" ");return w=r[0],_=r[1],o+i.length-1}var u=t.length,a=0,p=1,h=a,f=null,m=null,g="",y=[],b=!1,v=0,k=0,w="{{",_="}}";for(o&&(o=o.split(" "),w=o[0],_=o[1]),v=0;v<u;v++)h==a?i(w,t,v)?(--v,r(),h=p):"\n"==t.charAt(v)?c(b):g+=t.charAt(v):h==p?(v+=w.length-1,m=P[t.charAt(v+1)],f=m?t.charAt(v+1):"_v","="==f?(v=s(t,v),h=a):(m&&v++,h=2),b=v):i(_,t,v)?(y.push({tag:f,n:e(g),otag:w,ctag:_,i:"/"==f?b-_.length:v+w.length}),g="",v+=_.length-1,h=a,"{"==f&&("}}"==_?v++:n(y[y.length-1]))):g+=t.charAt(v);return c(b,!0),y},t.generate=function(n,e,i){var o='var _=this;_.b(i=i||"");'+u(n)+"return _.fl();";return i.asString?"function(c,p,i){"+o+";}":new t.Template(new Function("c","p","i",o),e,t,i)},t.parse=function(t,n,e){return e=e||{},o(t,"",[],e.sectionTags||[])},t.cache={},t.compile=function(t,n){n=n||{};var e=t+"||"+!!n.asString,i=this.cache[e];return i||(i=this.generate(this.parse(this.scan(t,n.delimiters),t,n),t,n),this.cache[e]=i)}}("undefined"!=typeof exports?exports:Hogan),function(){window.sleep=function(t,n){var e;return e=1e3*t,window._sleeping=setTimeout(n,e)}}.call(this),function(){var t=[].slice;window.Pinkman=function(){function n(){}return n.collections=[],n.objects=[],n.all=[],n.get=function(t){return this.all[t]},n.count=function(){return this.all.length},n.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},n.isArray=function(t){return null!=t&&t.constructor===Array},n.isString=function(t){return null!=t&&"string"==typeof t},n.doAfter=function(t,n,e){return null==e&&(e="_pinkman_doAfter"),window[e]=window.setTimeout(n,100*t)},n.clearTimeout=function(t){return null==t&&(t="_pinkman_doAfter"),window.clearTimeout(window[t])},n.defineGlobalVar=function(t,n){return window[t]=n},n.onlyOnce=function(){var n,e,i;if(e=arguments[0],n=2<=arguments.length?t.call(arguments,1):[],"function"==typeof e&&(i=new Object,i.f=e.toString(),i.args=n,-1===this.calledFunctions.indexOf(i)))return this.calledFunctions.push(i),e.apply(null,n)},n.calledFunctions=[],n}()}.call(this),function(){var t=[].slice;window.PinkmanCommon=function(){function n(){}return n.privateAttributes=["isPink","isObject","isCollection","pinkey","config","pinkmanType","collections","renderQueue"],n.mixin=function(){var n;return n=1<=arguments.length?t.call(arguments,0):[],Pinkman.mixin.apply(Pinkman,n)},n.mixit=function(){var n;return n=1<=arguments.length?t.call(arguments,0):[],Pinkman.mixit.apply(Pinkman,[this].concat(t.call(n)))},n.isInstance=function(t){return t.constructor===this},n.prototype.api=function(){if(null!=this.config&&null!=this.config.api)return"/"===this.config.api.charAt(0)?this.config.api+"/":"/"+this.config.api+"/"},n.prototype.isInstanceOf=function(t){return this.constructor===t},n.prototype.className=function(){return this.constructor.name},n.prototype.set=function(t,n,e){if(null==e&&(e=""),null!=t&&null!=n)return this[t]=n,"function"==typeof e&&e(this),this.watch&&this.reRender(),!0},n.prototype.render=function(t){if("object"==typeof t)return t.object=this,Pinkman.render(t)},n.prototype.reRender=function(){return Pinkman.reRender(this)},n}()}.call(this),function(){var t=function(t,e){function i(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},n={}.hasOwnProperty;window.PinkmanObject=function(n){function e(t){this.isPink=!0,this.isObject=!0,this.pinkmanType="object",this.collections=new PinkmanCollection,this.pinkey=Pinkman.all.length,Pinkman.objects.push(this),Pinkman.all.push(this),this.initialize(t)}return t(e,n),e.pinkmanType="object",e.prototype.initialize=function(t){var n,i,o;if("object"==typeof t){i=[];for(n in t)o=t[n],-1===e.privateAttributes.indexOf(n)?i.push(this.set(n,o)):i.push(void 0);return i}},e.prototype.assign=function(t){var n,e;if("object"==typeof t){for(n in t)e=t[n],"object"!=typeof e||null==this[n]||null==this[n].isPink||e.isPink?this.set(n,e):this[n].assign(e);return!0}return!1},e.prototype.attributes=function(){var t,n,i,o;t=new Object,i=this;for(n in i)o=i[n],-1===e.privateAttributes.indexOf(n)&&"function"!=typeof o&&(o.isPink?t[n]=o.attributes():t[n]=o);return t},e.prototype.attributesKeys=function(){return Object.keys(this.attributes())},e.prototype.keys=function(){return this.attributesKeys()},e.prototype.toString=function(){var t,n,e,i,o;for(n=[],n.push("("+this.className()+")"),o=this.attributesKeys(),e=0,i=o.length;e<i;e++)t=o[e],n.push(t+": "+this[t]+";");return n.join(" ")},e.prototype.next=function(t){var n;if(null==t&&(t=""),t.isPink&&"collection"===t.pinkmanType)return t.next(this);if(Pinkman.isNumber(t)){if(null!=(n=this.collections.get(t)))return n.next(this)}else if((null==t||""===t)&&this.collections.any())return this.collections.first().next(this)},e.prototype.prev=function(t){var n;if(null==t&&(t=""),t.isPink&&"collection"===t.pinkmanType)return t.prev(this);if(Pinkman.isNumber(t)){if(null!=(n=this.collections.get(t)))return n.prev(this)}else if((null==t||""===t)&&this.collections.any())return this.collections.first().prev(this)},e.prototype.clearCollections=function(){var t,n,e,i,o;for(i=this.collections.collection,o=[],n=0,e=i.length;n<e;n++)t=i[n],o.push(t.remove(this));return o},e.prototype.firstError=function(){var t;if(null!=this.errors)return(t=Object.keys(this.errors)[0])+" "+this.errors[t][0]},e}(window.PinkmanCommon),window.Pinkman.object=window.PinkmanObject}.call(this),function(){var t=function(t,e){function i(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},n={}.hasOwnProperty,e=[].slice;window.PinkmanCollection=function(n){function i(){this.isPink=!0,this.isCollection=!0,this.pinkmanType="collection",this.collection=[],this.pinkey=Pinkman.all.length,Pinkman.collections.push(this),Pinkman.all.push(this)}return t(i,n),i.pinkmanType="collection",i.prototype.config={memberClass:PinkmanObject},i.prototype.attributes=function(){return this.collection},i.prototype.count=function(t){var n,e,i,o,r;if(null==t&&(t=""),null!=t&&"function"==typeof t){for(n=0,r=this.collection,e=0,i=r.length;e<i;e++)o=r[e],t(o)&&n++;return n}return this.collection.length},i.prototype.size=function(t){return null==t&&(t=""),this.count(t)},i.prototype.length=function(t){return null==t&&(t=""),this.count(t)},i.prototype.each=function(t){var n,e,i,o;if(null==t&&(t=""),null!=t&&"function"==typeof t)for(o=this.collection,n=0,e=o.length;n<e;n++)i=o[n],t(i);return this},i.prototype.select=function(t,n){var e;return null==n&&(n=""),e=new this.constructor,"function"==typeof t?this.each(function(n){if(t(n))return e.push(n)}):"object"==typeof t&&this.each(function(n){var i,o,r;r=!0;for(i in t)o=t[i],n[i]!==o&&(r=!1);if(r)return e.push(n)}),"function"==typeof n&&n(e),e},i.prototype.push=function(t){var n,e,i;if(Pinkman.isArray(t)){for(e=0,i=t.length;e<i;e++)n=t[e],this.pushIndividually(n);return this.include(t)}return this.pushIndividually(t)},i.prototype.unshift=function(t){var n,e,i;if(Pinkman.isArray(t)){for(e=0,i=t.length;e<i;e++)n=t[e],this.unshiftIndividually(n);return this.include(t)}return this.unshiftIndividually(t)},i.prototype.pushIndividually=function(t){return null!=t&&"object"==typeof t&&!this.include(t)&&this.beforeInsertionPrep(t,function(t){return function(n){return t.collection.push(n),n.isObject&&null!=n.collections&&n.collections.push(t),!0}}(this))},i.prototype.directPush=function(t){if(!this.include(t))return this.collection.push(t)},i.prototype.forcePush=function(t){return this.collection.push(t)},i.prototype.unshiftIndividually=function(t){return null!=t&&"object"==typeof t&&!this.include(t)&&this.beforeInsertionPrep(t,function(t){return function(n){return t.collection.unshift(n),n.isObject&&null!=n.collections&&n.collections.push(t),!0}}(this))},i.prototype.beforeInsertionPrep=function(t,n){var e;return null==n&&(n=""),t.isPink||(e=this["new"](),e.assign(t),t=e),"function"==typeof n&&n(t),t},i.prototype.pop=function(){return this.remove(this.last())},i.prototype.shift=function(){return this.remove(this.first())},i.prototype.remove=function(t){var n;if(null!=t)return n=this.collection.indexOf(t),this.collection.splice(n,1),t},i.prototype.removeBy=function(t,n){if(null!=t&&null!=n)return this.remove(this.getBy(t,n))},i.prototype.removeAll=function(){return!this.any()||(this.remove(this.first()),this.removeAll())},i.prototype.include=function(t){var n,e,i,o;if(null!=t&&Pinkman.isArray(t)){for(o=!0,e=0,i=t.length;e<i;e++)n=t[e],this.include(n)||(o=!1);return o}return null!=t&&"object"==typeof t&&(null!=t.id?this.any(function(n){return t.id===n.id}):-1!==this.collection.indexOf(t))},i.prototype.first=function(t){return null==t&&(t=1),1===t?this.collection[0]:this.collection.slice(0,+(t-1)+1||9e9)},i.prototype.last=function(t){return null==t&&(t=1),1===t?this.collection[this.collection.length-1]:this.collection.slice(this.collection.length-t-1)},i.prototype.any=function(t){return null==t&&(t=""),null!=t&&"function"==typeof t?this.select(t).count()>0:this.count()>0},i.prototype.getBy=function(t,n){var e;if(null!=t&&null!=n)return e=new Object,e[t]=n,this.getByAttributes(e)},i.prototype.getByAttributes=function(t){var n,e,i,o,r,l,c;if(null==t||"object"!=typeof t||!this.any())return null;for(l=this.collection,n=0,i=l.length;n<i;n++){r=l[n],o=!0;for(e in t)c=t[e],r[e]!==c&&(o=!1);if(o)return r}},i.prototype.getByPinkey=function(t){return this.getBy("pinkey",t)},i.prototype.get=function(){var t;if(t=1<=arguments.length?e.call(arguments,0):[],t.length>0){if(Pinkman.isNumber(t[0]))return this.getByPinkey(t[0]);if(2===t.length)return this.getBy.apply(this,t);if("object"==typeof t[0])return this.getByAttributes(t[0])}},i.prototype.find=function(t){if(null!=t)return this.getBy("id",t)},i.prototype.next=function(t){var n;return n=this.collection.indexOf(t),this.collection[n+1]},i.prototype.prev=function(t){var n;return n=this.collection.indexOf(t),this.collection[n-1]},i.prototype.logPinkeys=function(){return this.each(function(t){return console.log(t.pinkey)})},i.prototype.uniq=function(t){var n,e,i,o;for(null==t&&(t=""),e=[],this.each(function(t){return function(n){return t.each(function(t){if(null!=n.pinkey&&n.pinkey===t.pinkey&&n!==t&&e.push(t),null!=n.id&&n.id===t.id&&n!==t)return e.push(t)})}}(this)),i=0,o=e.length;i<o;i++)n=e[i],this.remove(n);return this},i.prototype.fetchFromArray=function(t){var n,e,i,o;for(e=0,i=t.length;e<i;e++)n=t[e],o=this.beforeInsertionPrep(n),null!=o&&null!=this.find(o.id)?this.find(o.id).assign(o.attributes()):this.push(o);return this},i.prototype.merge=function(t){return Pinkman.isArray(t)?this.fetchFromArray(t):"object"==typeof t&&t.isPink&&t.isCollection?this.fetchFromArray(t.collection):void 0},i.prototype["new"]=function(t){var n;return n=new this.config.memberClass,n.initialize(t),this.push(n),n},i.prototype.reload=function(t){if(null==t&&(t=""),this.any())return this.each(function(n){return function(e){if(null!=e.id)return e.reload(function(e){if(e.pinkey===n.last().pinkey&&"function"===t)return t(n)})}}(this))},i.prototype.makeIndex=function(){var t,n,e,i,o;if(this.any()){for(t=1,o=this.collection,n=0,e=o.length;n<e;n++)i=o[n],i.set("index",t),t++;return!0}return!1},i.prototype.shuffle=function(){var t,n,e,i;if(null!=this.any){for(t=this.collection.length,e=[];0!==t;)n=Math.floor(Math.random()*t),t-=1,i=this.collection[t],this.collection[t]=this.collection[n],e.push(this.collection[n]=i);return e}},i.prototype.filter=function(t,n,e){var i,o,r,l,c;if(null!=t&&null!=n&&""!==n&&"string"==typeof t){if(this.any())for(i=new this.constructor,c=this.collection,o=0,r=c.length;o<r;o++)l=c[o],l[t]===n?i.push(l):null!=l[t]&&"string"==typeof l[t]&&""!==l[t]&&"string"==typeof n&&""!==n&&l[field].toLowerCase().indexOf(n.toLowerCase())>-1&&i.push(l);return null!=e&&"function"==typeof e&&e(i),i}return!1},i.prototype.fetch=function(t){return null==t&&(t=""),this.fetchFromUrl(this.api(),t)},i.prototype.fetchFrom=function(t,n,e){return null==e&&(e=""),null!=t&&null!=n&&this.fetchFromUrl(this.api()+(t+"/")+n,e)},i.prototype.fetchFromUrl=function(t){var n,e;if("undefined"!=typeof object&&null!==object&&"object"==typeof t&&null!=t.url)return n=null!=t.limit?t.limit:1e3,e=null!=t.offset?t.offset:0,this.fetchingFrom=t.url,Pinkman.ajax.get({url:t.url+"?limit="+n+"&offset="+e,complete:function(n){return function(e){var i;if(null!=e.errors||null!=e.error)throw i=[e.errors,e.error],n.errors=i[0],n.error=i[1],null!=e.errors?new Error('Oh no... I could not fetch your records, bitch. (jk... about the "bitch" part)'):new Error(e.error);return n.fetchFromArray(e).emptyResponse=0===e.length,null!=t.callback&&"function"==typeof t.callback&&t.callback(n),n}}(this)})},i.prototype.fetchMore=function(t,n){return null==t&&(t=10),null==n&&(n=""),null!=this.fetchingFrom?this.fetchFromUrl({url:this.fetchingFrom,limit:t,offset:this.count(),callback:n}):this.fetchFromUrl({url:this.api(),limit:t,offset:this.count(),callback:n})},i.prototype.fetchMoreFrom=function(t,n,e,i){return null==i&&(i=""),this.fetchFromUrl({url:this.api()+(n+"/")+e,limit:t,offset:this.count(),callback:i})},i.prototype.search=function(t,n){return null==n&&(n=""),this.removeAll(),this.fetchFromUrl({url:this.api()+"search?query="+t,callback:n})},i}(window.PinkmanCommon),window.Pinkman.collection=window.PinkmanCollection}.call(this),function(){window.Pinkman.mixin=function(t,n){var e;if(null!=t&&"string"==typeof t&&null!=n&&"object"==typeof n)return null==Pinkman.mixins&&(Pinkman.mixins=new Pinkman.collection),e=new Pinkman.object,e.set("mix",n),e.set("name",t),Pinkman.mixins.push(e)},window.Pinkman.mixit=function(t,n){var e,i,o,r;if(null!=(i=Pinkman.mixins.getBy("name",n))){r=i.mix;for(o in r)e=r[o],e["super"]=t.prototype[o],t.prototype[o]=e;return!0}return!1}}.call(this),function(){var t=[].slice;PinkmanCollection.prototype.renderQueue=new PinkmanCollection,PinkmanObject.prototype.renderQueue=new PinkmanCollection,Pinkman.templates=new Pinkman.collection,Pinkman.template_engine="hogan",Pinkman.template_engines={handlebars:function(t){var n,e;if(null!=t&&null!=t.template&&$("#"+t.template).length)return Pinkman.templates.include({template:t.template,engine:Pinkman.template_engine})?e=Pinkman.templates.get({template:t.template,engine:Pinkman.template_engine}):(e=new Pinkman.object({template:t.template,engine:Pinkman.template_engine}),e.handlebars=Handlebars.compile($("#"+t.template).html()),Pinkman.templates.push(e)),null!=t.context&&(t.object=t.context),n=e.handlebars(t.object),null!=t.target&&($("#"+t.target).html(n),null!=t.object&&"object"==typeof t.object&&t.object.isPink&&$("#"+t.target).attr("data-pinkey",t.object.pinkey)),null!=t.callback&&"function"==typeof t.callback&&t.callback(t.object,n),n},hogan:function(t){var n,e;if(null!=t&&null!=t.template&&$("#"+t.template).length)return Pinkman.templates.include({template:t.template,engine:Pinkman.template_engine})?e=Pinkman.templates.get({template:t.template,engine:Pinkman.template_engine}):(e=new Pinkman.object({template:t.template,engine:Pinkman.template_engine}),e.hogan=Hogan.compile($("#"+t.template).html()),Pinkman.templates.push(e)),null!=t.context&&(t.object=t.context),n=e.hogan.render(t.object),null!=t.target&&($("#"+t.target).html(n),null!=t.object&&"object"==typeof t.object&&t.object.isPink&&$("#"+t.target).attr("data-pinkey",t.object.pinkey)),null!=t.callback&&"function"==typeof t.callback&&t.callback(t.object,n),n},markup:function(n){var e,i;if(null!=n&&null!=n.template&&$("#"+n.template).length)return Pinkman.templates.include({template:n.template,engine:Pinkman.template_engine})?i=Pinkman.templates.get({template:n.template,engine:Pinkman.template_engine}):(i=new Pinkman.object({template:n.template,engine:Pinkman.template_engine}),i.markup=function(){var n;return n=1<=arguments.length?t.call(arguments,0):[],Mark.up.apply(Mark,n)},Pinkman.templates.push(i)),null!=n.context&&(n.object=n.context),e=i.markup($("#"+n.template).html(),n.object),null!=n.target&&($("#"+n.target).html(e),null!=n.object&&"object"==typeof n.object&&n.object.isPink&&$("#"+n.target).attr("data-pinkey",n.object.pinkey)),null!=n.callback&&"function"==typeof n.callback&&n.callback(n.object,e),e}},Pinkman.render=function(t){var n;if(null!=t.reRender&&!1===t.reRender||(t.reRender=!0),n=Pinkman.template_engines[Pinkman.template_engine],n(t),t.reRender&&null!=t.object&&t.object.isPink)return t.object.renderQueue.directPush(t)},Pinkman.reRender=function(t){var n,e,i,o,r;for(n=Pinkman.template_engines[Pinkman.template_engine],r=t.renderQueue.collection,e=0,i=r.length;e<i;e++)o=r[e],n(o);return t.renderQueue.any()}}.call(this),function(){var t=function(t,e){function i(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},n={}.hasOwnProperty,e=[].slice;Pinkman.maxSearchLevel=15,Pinkman.closest=function(t,n){var e;return null==n&&(n=0),t.is("[data-pinkey]")?(e=t.data("pinkey"),Pinkman.get(e)):n<Pinkman.maxSearchLevel?Pinkman.closest(t.parent(),n+1):null},window.PinkmanController=function(n){function i(){var t;t=1<=arguments.length?e.call(arguments,0):[],this.actions=new PinkmanActions,i.__super__.constructor.apply(this,t)}return t(i,n),i.prototype.build=function(){return null!=this.builder&&"function"==typeof this.builder&&(this.builder(this),null!=this.main&&"function"==typeof this.main&&this.main(),!0)},i.prototype.action=function(){var t,n,i,o,r;return n=1<=arguments.length?e.call(arguments,0):[],1===n.length?this.actions.getBy("name",n[0]):(r=n[0],o=n[1],i=n[2],4<=n.length?e.call(n,3):[],t=new PinkmanAction({name:r,eventName:o,call:i,controller:this}),this.actions.push(t),null!=t.call&&"function"==typeof t.call&&t.listen(),t)},i.prototype.bind=function(t,n){return null==n&&(n=""),this.action(t,["keyup","change"],function(){var i,o,r;if(r=arguments[0],o=arguments[1],i=3<=arguments.length?e.call(arguments,2):[],r[t]!==o.val()&&(r.set(t,o.val()),null!=n&&"function"==typeof n))return n.apply(null,[r,o].concat(e.call(i)))})},i.prototype.bindAll=function(){},i.prototype.bottom=function(t){return setTimeout(function(){return null==window._pinkman_lastEndOfPage&&(window._pinkman_lastEndOfPage=0),$(window).scroll(function(){var n,e;if(e=Date.now(),((n=$(document).height()-$(window).scrollTop()-document.body.offsetHeight)<800&&window._pinkman_lastEndOfPage<e||0===n)&&!window._pinkman_bottomTriggered)return window._pinkman_bottomTriggered=!0,window._pinkman_lastEndOfPage=e,t()})},50)},i.prototype.endBottom=function(){return window._pinkman_bottomTriggered=!1},i.prototype.drop=function(t,n){return this.action(t,"click",function(t,e,i){if(null!=n.click&&"function"==typeof n.click)return n.click(t,e,i)}),this.action(t,"dragenter",function(t,e,i){if(null!=n.enter&&"function"==typeof n.enter)return n.enter(t,e,i)}),this.action(t,"dragover",function(t,e,i){if(null!=n.over&&"function"==typeof n.over)return n.over(t,e,i)}),this.action(t,"dragleave",function(t,e,i){return n.leave(t,e,null!=n.leave&&"function"==typeof n.leave?i:void 0)}),this.action(t,"drop",function(t,e,i){if(null!=n.drop&&"function"==typeof n.drop&&n.drop(t,e,i),null!=n.files&&"function"==typeof n.files)return n.files(t,i.originalEvent.dataTransfer.files)})},i}(window.PinkmanObject),window.PinkmanControllers=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return t(e,n),e}(window.PinkmanCollection),window.PinkmanAction=function(n){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.mirror=function(t,n){var i;return i=new PinkmanActions,Pinkman.controllers.select({id:t}).each(function(t){return t.actions.select({name:n}).each(function(t){return i.push(t)})}),this.controller.action(this.name,this.eventName,function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],i.each(function(n){return n.call.apply(n,t)})})},i.prototype.redirect=function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],this.mirror.apply(this,t)},i.prototype.redirectTo=function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],this.mirror.apply(this,t)},i.prototype.attach=function(t){var n;if(Pinkman.isString(t))return n=this,$("body").on(t,"#"+n.controller.id+" [data-action='"+n.name+"']",function(e){var i;return"keypress"!==t&&e.preventDefault(),i=window.Pinkman.closest($(this)),n.call(i,$(this),e)})},i.prototype.listen=function(){var t,n,e,i,o;if(Pinkman.isString(this.eventName))return this.attach(this.eventName);if(Pinkman.isArray(this.eventName)){for(i=this.eventName,o=[],n=0,e=i.length;n<e;n++)t=i[n],o.push(this.attach(t));return o}},i}(window.PinkmanObject),window.PinkmanActions=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return t(e,n),e}(window.PinkmanCollection),Pinkman.controllers=new window.PinkmanControllers,Pinkman.controllers.isActive=function(t){return null!=this.find(t)},Pinkman.controllers.def=function(t,n){return $(document).ready(function(){var e;return null!=t&&null!=n&&$("#"+t).length>0&&(e=new PinkmanController({id:t,builder:n}),Pinkman.controllers.push(e),e.build())})},Pinkman.controller=function(){var t,n;return t=1<=arguments.length?e.call(arguments,0):[],1===t.length?Pinkman.controllers.find(t[0]):(n=Pinkman.controllers).def.apply(n,t)}}.call(this),function(){}.call(this),function(){(function(){(function(){var n=[].slice;this.ActionCable={INTERNAL:{message_types:{welcome:"welcome",ping:"ping",confirmation:"confirm_subscription",rejection:"reject_subscription"},default_mount_path:"/cable",protocols:["actioncable-v1-json","actioncable-unsupported"]},createConsumer:function(n){var e;return null==n&&(n=null!=(e=this.getConfig("url"))?e:this.INTERNAL.default_mount_path),new t.Consumer(this.createWebSocketURL(n))},getConfig:function(t){var n;return n=document.head.querySelector("meta[name='action-cable-"+t+"']"),null!=n?n.getAttribute("content"):void 0},createWebSocketURL:function(t){var n;return t&&!/^wss?:/i.test(t)?(n=document.createElement("a"),n.href=t,n.href=n.href,n.protocol=n.protocol.replace("http","ws"),n.href):t},startDebugging:function(){return this.debugging=!0},stopDebugging:function(){return this.debugging=null},log:function(){var t;if(t=1<=arguments.length?n.call(arguments,0):[],this.debugging)return t.push(Date.now()),console.log.apply(console,["[ActionCable]"].concat(n.call(t)))}}}).call(this)}).call(this);var t=this.ActionCable;(function(){(function(){var n=function(t,n){return function(){return t.apply(n,arguments)}};t.ConnectionMonitor=function(){function e(t){this.connection=t,this.visibilityDidChange=n(this.visibilityDidChange,this),this.reconnectAttempts=0}var i,o,r;return e.pollInterval={min:3,max:30},e.staleThreshold=6,e.prototype.start=function(){if(!this.isRunning())return this.startedAt=o(),delete this.stoppedAt,this.startPolling(),document.addEventListener("visibilitychange",this.visibilityDidChange),t.log("ConnectionMonitor started. pollInterval = "+this.getPollInterval()+" ms")},e.prototype.stop=function(){if(this.isRunning())return this.stoppedAt=o(),this.stopPolling(),document.removeEventListener("visibilitychange",this.visibilityDidChange),t.log("ConnectionMonitor stopped")},e.prototype.isRunning=function(){return null!=this.startedAt&&null==this.stoppedAt},e.prototype.recordPing=function(){return this.pingedAt=o()},e.prototype.recordConnect=function(){return this.reconnectAttempts=0,this.recordPing(),delete this.disconnectedAt,t.log("ConnectionMonitor recorded connect")},e.prototype.recordDisconnect=function(){return this.disconnectedAt=o(),t.log("ConnectionMonitor recorded disconnect")},e.prototype.startPolling=function(){return this.stopPolling(),this.poll()},e.prototype.stopPolling=function(){return clearTimeout(this.pollTimeout)},e.prototype.poll=function(){return this.pollTimeout=setTimeout(function(t){return function(){return t.reconnectIfStale(),t.poll()}}(this),this.getPollInterval())},e.prototype.getPollInterval=function(){var t,n,e,o;return o=this.constructor.pollInterval,e=o.min,n=o.max,t=5*Math.log(this.reconnectAttempts+1),Math.round(1e3*i(t,e,n))},e.prototype.reconnectIfStale=function(){if(this.connectionIsStale())return t.log("ConnectionMonitor detected stale connection. reconnectAttempts = "+this.reconnectAttempts+", pollInterval = "+this.getPollInterval()+" ms, time disconnected = "+r(this.disconnectedAt)+" s, stale threshold = "+this.constructor.staleThreshold+" s"),this.reconnectAttempts++,this.disconnectedRecently()?t.log("ConnectionMonitor skipping reopening recent disconnect"):(t.log("ConnectionMonitor reopening"),this.connection.reopen())},e.prototype.connectionIsStale=function(){var t;return r(null!=(t=this.pingedAt)?t:this.startedAt)>this.constructor.staleThreshold},e.prototype.disconnectedRecently=function(){return this.disconnectedAt&&r(this.disconnectedAt)<this.constructor.staleThreshold},e.prototype.visibilityDidChange=function(){if("visible"===document.visibilityState)return setTimeout(function(n){return function(){if(n.connectionIsStale()||!n.connection.isOpen())return t.log("ConnectionMonitor reopening stale connection on visibilitychange. visbilityState = "+document.visibilityState),n.connection.reopen()}}(this),200)},o=function(){return(new Date).getTime()},r=function(t){return(o()-t)/1e3},i=function(t,n,e){return Math.max(n,Math.min(e,t))},e}()}).call(this),function(){var n,e,i,o,r,l=[].slice,c=function(t,n){return function(){return t.apply(n,arguments)}},s=[].indexOf||function(t){for(var n=0,e=this.length;n<e;n++)if(n in this&&this[n]===t)return n;return-1};o=t.INTERNAL,e=o.message_types,i=o.protocols,r=2<=i.length?l.call(i,0,n=i.length-1):(n=0,[]),i[n++],t.Connection=function(){function n(n){this.consumer=n,this.open=c(this.open,this),this.subscriptions=this.consumer.subscriptions,this.monitor=new t.ConnectionMonitor(this),this.disconnected=!0}return n.reopenDelay=500,n.prototype.send=function(t){return!!this.isOpen()&&(this.webSocket.send(JSON.stringify(t)),!0)},n.prototype.open=function(){if(this.isActive())throw t.log("Attempted to open WebSocket, but existing socket is "+this.getState()),new Error("Existing connection must be closed before opening");return t.log("Opening WebSocket, current state is "+this.getState()+", subprotocols: "+i),null!=this.webSocket&&this.uninstallEventHandlers(),this.webSocket=new WebSocket(this.consumer.url,i),this.installEventHandlers(),this.monitor.start(),!0},n.prototype.close=function(t){var n,e;if(n=(null!=t?t:{allowReconnect:!0}).allowReconnect,n||this.monitor.stop(),this.isActive())return null!=(e=this.webSocket)?e.close():void 0},n.prototype.reopen=function(){var n;if(t.log("Reopening WebSocket, current state is "+this.getState()),!this.isActive())return this.open();try{return this.close()}catch(e){return n=e,t.log("Failed to reopen WebSocket",n)}finally{t.log("Reopening WebSocket in "+this.constructor.reopenDelay+"ms"),setTimeout(this.open,this.constructor.reopenDelay)}},n.prototype.getProtocol=function(){var t;return null!=(t=this.webSocket)?t.protocol:void 0},n.prototype.isOpen=function(){return this.isState("open")},n.prototype.isActive=function(){return this.isState("open","connecting")},n.prototype.isProtocolSupported=function(){var t;return t=this.getProtocol(),s.call(r,t)>=0},n.prototype.isState=function(){var t,n;return n=1<=arguments.length?l.call(arguments,0):[],t=this.getState(),s.call(n,t)>=0},n.prototype.getState=function(){var t,n;for(n in WebSocket)if(WebSocket[n]===(null!=(t=this.webSocket)?t.readyState:void 0))return n.toLowerCase();return null},n.prototype.installEventHandlers=function(){var t,n;for(t in this.events)n=this.events[t].bind(this),this.webSocket["on"+t]=n},n.prototype.uninstallEventHandlers=function(){var t;for(t in this.events)this.webSocket["on"+t]=function(){}},n.prototype.events={message:function(t){var n,i,o,r;if(this.isProtocolSupported())switch(o=JSON.parse(t.data),n=o.identifier,i=o.message,r=o.type,r){case e.welcome:return this.monitor.recordConnect(),this.subscriptions.reload();case e.ping:
return this.monitor.recordPing();case e.confirmation:return this.subscriptions.notify(n,"connected");case e.rejection:return this.subscriptions.reject(n);default:return this.subscriptions.notify(n,"received",i)}},open:function(){if(t.log("WebSocket onopen event, using '"+this.getProtocol()+"' subprotocol"),this.disconnected=!1,!this.isProtocolSupported())return t.log("Protocol is unsupported. Stopping monitor and disconnecting."),this.close({allowReconnect:!1})},close:function(){if(t.log("WebSocket onclose event"),!this.disconnected)return this.disconnected=!0,this.monitor.recordDisconnect(),this.subscriptions.notifyAll("disconnected",{willAttemptReconnect:this.monitor.isRunning()})},error:function(){return t.log("WebSocket onerror event")}},n}()}.call(this),function(){var n=[].slice;t.Subscriptions=function(){function e(t){this.consumer=t,this.subscriptions=[]}return e.prototype.create=function(n,e){var i,o,r;return i=n,o="object"==typeof i?i:{channel:i},r=new t.Subscription(this.consumer,o,e),this.add(r)},e.prototype.add=function(t){return this.subscriptions.push(t),this.consumer.ensureActiveConnection(),this.notify(t,"initialized"),this.sendCommand(t,"subscribe"),t},e.prototype.remove=function(t){return this.forget(t),this.findAll(t.identifier).length||this.sendCommand(t,"unsubscribe"),t},e.prototype.reject=function(t){var n,e,i,o,r;for(i=this.findAll(t),o=[],n=0,e=i.length;n<e;n++)r=i[n],this.forget(r),this.notify(r,"rejected"),o.push(r);return o},e.prototype.forget=function(t){var n;return this.subscriptions=function(){var e,i,o,r;for(o=this.subscriptions,r=[],e=0,i=o.length;e<i;e++)(n=o[e])!==t&&r.push(n);return r}.call(this),t},e.prototype.findAll=function(t){var n,e,i,o,r;for(i=this.subscriptions,o=[],n=0,e=i.length;n<e;n++)r=i[n],r.identifier===t&&o.push(r);return o},e.prototype.reload=function(){var t,n,e,i,o;for(e=this.subscriptions,i=[],t=0,n=e.length;t<n;t++)o=e[t],i.push(this.sendCommand(o,"subscribe"));return i},e.prototype.notifyAll=function(){var t,e,i,o,r,l,c;for(e=arguments[0],t=2<=arguments.length?n.call(arguments,1):[],r=this.subscriptions,l=[],i=0,o=r.length;i<o;i++)c=r[i],l.push(this.notify.apply(this,[c,e].concat(n.call(t))));return l},e.prototype.notify=function(){var t,e,i,o,r,l,c;for(l=arguments[0],e=arguments[1],t=3<=arguments.length?n.call(arguments,2):[],c="string"==typeof l?this.findAll(l):[l],r=[],i=0,o=c.length;i<o;i++)l=c[i],r.push("function"==typeof l[e]?l[e].apply(l,t):void 0);return r},e.prototype.sendCommand=function(t,n){var e;return e=t.identifier,this.consumer.send({command:n,identifier:e})},e}()}.call(this),function(){t.Subscription=function(){function t(t,e,i){this.consumer=t,null==e&&(e={}),this.identifier=JSON.stringify(e),n(this,i)}var n;return t.prototype.perform=function(t,n){return null==n&&(n={}),n.action=t,this.send(n)},t.prototype.send=function(t){return this.consumer.send({command:"message",identifier:this.identifier,data:JSON.stringify(t)})},t.prototype.unsubscribe=function(){return this.consumer.subscriptions.remove(this)},n=function(t,n){var e,i;if(null!=n)for(e in n)i=n[e],t[e]=i;return t},t}()}.call(this),function(){t.Consumer=function(){function n(n){this.url=n,this.subscriptions=new t.Subscriptions(this),this.connection=new t.Connection(this)}return n.prototype.send=function(t){return this.connection.send(t)},n.prototype.connect=function(){return this.connection.open()},n.prototype.disconnect=function(){return this.connection.close({allowReconnect:!1})},n.prototype.ensureActiveConnection=function(){if(!this.connection.isActive())return this.connection.open()},n}()}.call(this)}).call(this),"object"==typeof module&&module.exports?module.exports=t:"function"==typeof define&&define.amd&&define(t)}.call(this),function(){this.App||(this.App={}),App.cable=ActionCable.createConsumer()}.call(this),function(){Pinkman.controller("index",function(t){return t.main=function(){return console.log("Pinkman controller up & running"),window.johnny=new PinkmanObject({title:Pinkman.template_engine,deep:{name:"Johnny Deep! Not Depp"}}),$("#index").attr("data-pinkey",johnny.pinkey),Pinkman.render({template:"template",target:"target",context:johnny}),johnny.render({template:"johnny-form",target:"form",reRender:!1})},t.action("paragraph","click",function(t,n){return null!=t&&(console.log("This paragraph is in the scope of the object below:"),console.log(t)),console.log("You clicked!"),console.log("content: "+n.html())}),t.bind("title"),t.action("callMeLater","click",function(){return console.log("You finally called me!")}),t.bottom(function(){return console.log("sleep"),sleep(2,function(){return t.endBottom(),console.log("wakeup"),t.action("callMeLater").call()})}),t.drop("drop-zone",{enter:function(){return console.log("entered")},leave:function(){return console.log("left")},over:function(){return console.log("hey! get off me!")},drop:function(){return console.log("dropou")},files:function(t,n){return console.log(n)}}),t.action("who-is-this","click",function(t){return console.log(t.deep)})}),Pinkman.controller("another",function(t){return t.action("another-paragraph","click").mirror("index","paragraph")})}.call(this);